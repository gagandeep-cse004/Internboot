<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>InternBoot | Create Account</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Poppins", sans-serif;
            background: linear-gradient(135deg, #002b8b, #007bff);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
        }

        .wrapper {
            display: flex;
            width: 90%;
            max-width: 1000px;
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .left-panel {
            background: linear-gradient(135deg, #0043c6, #007bff);
            color: #fff;
            padding: 40px;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .left-panel img {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            margin-bottom: 20px;
            background: #fff;
            padding: 8px;
        }

        .right-panel {
            flex: 1.5;
            padding: 40px;
            overflow-y: auto;
            max-height: 90vh;
        }

        .right-panel h3 {
            color: #003b9a;
            text-align: center;
            font-size: 22px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        label {
            display: block;
            margin-top: 12px;
            font-weight: 500;
        }

        input,
        select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            margin-top: 5px;
        }

        input[type="file"] {
            background: #f7f9fc;
        }

        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #0043c6, #007bff);
            color: white;
            border: none;
            border-radius: 8px;
            margin-top: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        button:hover {
            background: linear-gradient(135deg, #003ba8, #0066d9);
        }

        .error {
            color: red;
            text-align: center;
            margin-top: 8px;
            font-size: 13px;
        }

        .identity-section {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .identity-input {
            display: none;
            margin-top: 8px;
        }

        .footer {
            text-align: center;
            margin-top: 15px;
            font-size: 13px;
        }

        .footer a {
            color: #0056b3;
            text-decoration: none;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <div class="left-panel">
            <img src="https://media.licdn.com/dms/image/v2/D560BAQElN8CpYuEpAQ/company-logo_200_200/B56Zl16MEPJ4AI-/0/1758619812617/internboot_logo?e=2147483647&v=beta&t=qmQo26wvIvOf8hOg-MNLHH7TBUdAsyTXBr7EyL6BCXk"
                alt="InternBoot Logo" />
            <h2>Welcome to InternBoot</h2>
            <p>Join India's fastest-growing internship platform.</p>
        </div>

        <div class="right-panel">
            <h3>Create Your Account</h3>

            <form id="signupForm" enctype="multipart/form-data">
                <label>First Name</label>
                <input type="text" id="firstName" required />

                <label>Last Name</label>
                <input type="text" id="lastName" required />

                <label>Username</label>
                <input type="text" id="username" required />

                <label>Email</label>
                <input type="email" id="email" required />
                
                

                <style>
                    .form-group {
                        margin-bottom: 20px;
                    }
                
                    .form-group label {
                        display: block;
                        font-weight: 600;
                        margin-bottom: 6px;
                        color: #333;
                    }
                
                    .form-input {
                        width: 100%;
                        padding: 12px;
                        border: 1px solid #ccc;
                        border-radius: 8px;
                        font-size: 16px;
                        outline: none;
                        transition: 0.3s ease;
                        background: #fff;
                    }
                
                    .form-input:focus {
                        border-color: #6a9cff;
                        box-shadow: 0 0 6px rgba(106, 156, 255, 0.5);
                    }
                
                    .checkbox-wrapper {
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        margin: 10px 0 20px;
                        font-size: 15px;
                        font-weight: 500;
                        color: #444;
                    }
                
                    .checkbox-wrapper input[type="checkbox"] {
                        width: 18px;
                        height: 18px;
                        accent-color: #4caf50;
                        /* modern green tick */
                        cursor: pointer;
                    }
                </style>
                
                <div class="form-group">
                    <label>Mobile Number</label>
                    <input type="tel" id="mobile" class="form-input" pattern="[0-9]{10}" maxlength="10" required oninput="syncMobile()"
                        placeholder="Enter mobile number">
                </div>
                
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="sameAsMobile" onclick="toggleWhatsApp()" />
                    <label for="sameAsMobile">WhatsApp number is same as Mobile</label>
                </div>
                
                <div class="form-group">
                    <label>WhatsApp Number</label>
                    <input type="tel" id="whatsApp" class="form-input" pattern="[0-9]{10}" maxlength="10" required
                        placeholder="Enter WhatsApp number">
                </div>
                
                <script>
                    function toggleWhatsApp() {
                        const mobile = document.getElementById("mobile");
                        const whatsApp = document.getElementById("whatsApp");
                        const checkbox = document.getElementById("sameAsMobile");

                        if (checkbox.checked) {
                            whatsApp.value = mobile.value;
                            whatsApp.setAttribute("disabled", true);
                            whatsApp.style.backgroundColor = "#f5f5f5"; // light grey to show disabled
                        } else {
                            whatsApp.removeAttribute("disabled");
                            whatsApp.value = "";
                            whatsApp.style.backgroundColor = "#fff"; // reset background
                        }
                    }

                    function syncMobile() {
                        const mobileValue = document.getElementById("mobile").value;
                        const checkboxChecked = document.getElementById("sameAsMobile").checked;
                        if (checkboxChecked) {
                            document.getElementById("whatsApp").value = mobileValue;
                        }
                    }
                </script>


                <label>Password</label>
                <input type="password" id="password" placeholder="Min 8 chars & a number" required />

                <label>Profile Picture</label>
                <input type="file" id="profilePic" accept="image/*" required />

                <label>Key Skills</label>
                <input type="text" id="skills" placeholder="e.g. Java, Python, SQL" />

                <label>Employment Status</label>
                <select id="status" required>
                    <option value="">Select</option>
                    <option>Student</option>
                    <option>Employed</option>
                    <option>Unemployed</option>
                    <option>Freelancer</option>
                </select>

                <label>Education Level</label>
                <select id="education" required>
                    <option value="">Select</option>
                    <option>Undergraduate</option>
                    <option>Postgraduate</option>
                    <option>Diploma</option>
                    <option>PhD</option>
                </select>

                <label>Internship Category</label>
                <select id="category" required>
                    <option value="">Select Category</option>
                    <option>Digital Marketing Internships</option>
                    <option>Web Development Internships</option>
                    <option>Data Science/Data Analyst Internships</option>
                    <option>Cybersecurity Internships</option>
                    <option>HR Internships</option>
                    <option>Finance Analyst Internships</option>
                    <option>Sales Internships</option>
                    <option>Portfolio Management Internships</option>
                    <option>Software Development and Information Technology Internships</option>
                </select>

                <label>Internship Tenure (months)</label>
                <input type="number" id="tenure" min="1" placeholder="e.g. 6" required />

                <label>Organization Token (Optional)</label>
                <input type="text" id="token" />

                <div class="identity-section">
                    <label><input type="radio" name="identityType" value="aadhar" /> Aadhar (India)</label>
                    <label><input type="radio" name="identityType" value="passport" /> Passport (Foreign)</label>
                </div>

                <div id="aadharInput" class="identity-input">
                    <label>Aadhar Number</label>
                    <input type="text" id="aadhar" maxlength="12" pattern="[0-9]{12}" placeholder="12-digit number" />
                    <label>Aadhar Card Photo</label>
                    <input type="file" id="aadharFile" accept="image/*" />
                </div>

                <div id="passportInput" class="identity-input">
                    <label>Passport Number</label>
                    <input type="text" id="passport" maxlength="9" placeholder="e.g. N1234567" />
                    <label>Passport Photo</label>
                    <input type="file" id="passportFile" accept="image/*" />
                </div>

                <div class="error" id="errorMsg"></div>
                <button type="submit">Create Account</button>

                <div class="footer">
                    <p>Already have an account? <a href="login.html">Login here</a></p>
                </div>
            </form>
        </div>
    </div>

    <script>
        const form = document.getElementById('signupForm');
        const errorMsg = document.getElementById('errorMsg') || (() => { const d = document.createElement('div'); d.id = 'errorMsg'; form.prepend(d); return d; })();

        document.querySelectorAll('input[name="identityType"]').forEach(r => r.addEventListener('change', function () {
            document.getElementById('aadharInput').style.display = this.value === 'aadhar' ? 'block' : 'none';
            document.getElementById('passportInput').style.display = this.value === 'passport' ? 'block' : 'none';
        }));

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            errorMsg.textContent = '';

            const fd = new FormData();
            // required fields
            fd.append('firstName', form.firstName.value.trim());
            fd.append('lastName', form.lastName.value.trim());
            fd.append('username', form.username.value.trim());
            fd.append('email', form.email.value.trim());
            fd.append('mobile', form.mobile.value.trim());
            fd.append('whatsApp', form.whatsApp.value.trim());
            fd.append('password', form.password.value);
            fd.append('skills', form.skills.value);
            fd.append('status', form.status.value);
            fd.append('education', form.education.value);
            fd.append('category', form.category.value);
            fd.append('tenure', form.tenure.value);
            fd.append('token', form.token.value);

            if (form.profilePic.files.length) fd.append('profilePic', form.profilePic.files[0]);

            const identityType = form.querySelector('input[name="identityType"]:checked')?.value || '';
            fd.append('identityType', identityType);

            if (identityType === 'aadhar') {
                fd.append('aadhar', form.aadhar.value);
                if (form.aadharFile.files.length) fd.append('adhaar', form.aadharFile.files[0]); // note: back-end expects 'adhaar' file field
            } else if (identityType === 'passport') {
                fd.append('passport', form.passport.value);
                if (form.passportFile.files.length) fd.append('passport', form.passportFile.files[0]);
            }

            try {
                const res = await fetch('http://localhost:5000/api/auth/signup', {
                    method: 'POST',
                    body: fd
                });
                const data = await res.json();
                if (data.success) {
                    alert("Account created successfully");
                    
                } else {
                    errorMsg.textContent = data.message || 'Signup failed';
                }
                
            } catch (err) {
                console.error(err);
                errorMsg.textContent = 'Cannot reach server';
            }
        });
    </script>

    <!-- Firebase SDKs -->
    <script type="module">
        // Import Firebase SDK modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBazM-jidXQ16nBDPV2u17o96zxoNMfADw",
            authDomain: "internboot2025.firebaseapp.com",
            projectId: "internboot2025",
            storageBucket: "internboot2025.firebasestorage.app",
            messagingSenderId: "527155149561",
            appId: "1:527155149561:web:4fedcfb9119f0e40450028",
            measurementId: "G-BNGR3S0GFS"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);


        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            errorMsg.textContent = '';

            const email = form.email.value.trim();
            const password = form.password.value;

            try {
                // Step 1: Create Firebase User
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                // Step 2: Send email verification
                await sendEmailVerification(user);
                alert("Verification email sent! Please check your inbox.");

                // Step 3: Prepare data for your backend
                const fd = new FormData(form);
                fd.append('firebaseUid', user.uid);

                // Step 4: Save user profile in your backend
                const res = await fetch('http://localhost:5000/api/auth/signup', {
                    method: 'POST',
                    body: fd
                });

                const data = await res.json();
                if (data.success) {
                    alert("Account created! Verify your email before logging in.");
                    form.reset();
                } else {
                    errorMsg.textContent = data.message || "Signup failed on server.";
                }

            } catch (error) {
                console.error(error);
                errorMsg.textContent = error.message;
            }
        });
    </script>
</body>

</html>